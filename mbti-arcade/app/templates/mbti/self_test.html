{% extends "base.html" %}

{% block title %}내 MBTI 테스트 - MBTI & Arcade Web Service{% endblock %}

{% block head %}
<style>
    .question-card:focus-within {
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.35);
        border-color: rgba(59, 130, 246, 0.6);
    }

    .scale-option:focus-visible {
        outline: 3px solid rgba(59, 130, 246, 0.9);
        outline-offset: 4px;
    }
</style>
{% endblock %}

{% block content %}
{% set scale_options = [
    (1, "전혀 그렇지 않다"),
    (2, "그렇지 않은 편"),
    (3, "보통"),
    (4, "그런 편"),
    (5, "매우 그렇다")
] %}

<div class="mx-auto max-w-4xl space-y-10">
    <section class="rounded-3xl bg-gradient-to-br from-indigo-600 via-sky-500 to-emerald-500 px-6 py-10 text-white">
        <div class="max-w-3xl space-y-4">
            <h1 class="text-3xl md:text-4xl font-bold">
                🧠 내 MBTI 성격 유형 테스트
            </h1>
            <p class="text-base md:text-lg text-white/90">
                DesignOptions.md와 docs/frontend_style.md의 접근성·성능 기준을 반영한 문항 흐름입니다.
                각 문항은 "그 사람은..."으로 시작하며, 제3자 관점에서 자신을 객관적으로 바라보고 답해주세요.
            </p>
            <div class="flex flex-wrap gap-3 text-sm text-white/80">
                <span class="inline-flex items-center rounded-full bg-white/20 px-3 py-1">24문항 · 5점 Likert</span>
                <span class="inline-flex items-center rounded-full bg-white/20 px-3 py-1">WCAG 2.2 AA 대비</span>
                <span class="inline-flex items-center rounded-full bg-white/20 px-3 py-1">응답 시간 약 5분</span>
            </div>
        </div>
    </section>

    <form method="POST" action="/mbti/self-result" class="space-y-8">
        <section class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
            <h2 class="text-xl font-semibold text-slate-900">👤 개인 테스트 모드</h2>
            <p class="mt-2 text-sm text-slate-600">
                응답은 익명으로 저장되며, k≥3 응답이 모이지 않으면 공유 결과가 공개되지 않습니다.
                진행 상황은 자동 저장되지 않으므로 가능한 한 번에 완료해주세요.
            </p>
        </section>

        {% for question in questions %}
        {% set base_name = "q" ~ question.id %}
        <fieldset class="question-card rounded-2xl border border-slate-200 bg-white p-6 shadow-sm transition-colors" aria-describedby="{{ base_name }}-hint">
            <legend class="flex items-start gap-3 text-lg font-semibold text-slate-900">
                <span class="mt-1 inline-flex h-8 w-8 items-center justify-center rounded-full bg-indigo-600 text-sm font-bold text-white">{{ loop.index }}</span>
                <span>{{ question.question }}</span>
            </legend>
            <p id="{{ base_name }}-hint" class="mt-3 text-sm text-slate-500">
                1은 "전혀 그렇지 않다", 5는 "매우 그렇다"를 의미합니다. 방향키와 스페이스/엔터로 선택할 수 있습니다.
            </p>
            <div class="mt-5 grid gap-3 sm:grid-cols-2 lg:grid-cols-5" role="radiogroup">
                {% for value, label in scale_options %}
                {% set input_id = base_name ~ "-" ~ loop.index %}
                <label for="{{ input_id }}" class="scale-option flex items-center gap-3 rounded-xl border border-slate-200 px-4 py-3 text-sm font-medium text-slate-700 transition hover:border-indigo-400 hover:bg-indigo-50">
                    <input id="{{ input_id }}" type="radio" name="{{ base_name }}" value="{{ value }}" class="h-4 w-4 text-indigo-600" {% if loop.first %}required{% endif %}>
                    <span>{{ label }}</span>
                </label>
                {% endfor %}
            </div>
        </fieldset>
        {% endfor %}

        <div class="sticky bottom-6 z-10 flex justify-end">
            <button type="submit" class="inline-flex items-center gap-2 rounded-xl bg-indigo-600 px-6 py-3 text-base font-semibold text-white shadow-lg shadow-indigo-600/30 transition hover:-translate-y-0.5 hover:bg-indigo-700">
                🚀 결과 확인하기
            </button>
        </div>
    </form>
</div>
{% endblock %}

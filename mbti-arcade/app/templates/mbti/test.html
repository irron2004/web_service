{% extends "base.html" %}

{% block title %}MBTI í…ŒìŠ¤íŠ¸ - MBTI & Arcade Web Service{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
    <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-4">
            ğŸ§  MBTI ì„±ê²© ìœ í˜• í…ŒìŠ¤íŠ¸
        </h1>
        <p class="text-gray-600 mb-4">
            ê° ì§ˆë¬¸ì— ì†”ì§í•˜ê²Œ ë‹µí•´ì£¼ì„¸ìš”. ì •ë‹µì€ ì—†ìŠµë‹ˆë‹¤!
        </p>
        <div class="bg-blue-50 p-4 rounded-lg max-w-2xl mx-auto">
            <p class="text-sm text-blue-800">
                <strong>ğŸ’¡ í…ŒìŠ¤íŠ¸ ì•ˆë‚´:</strong> 
                {% if friend_info %}
                    ê° ë¬¸í•­ì€ "{{ friend_info.name }}ì€..."ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ì œ3ì ê´€ì ì˜ ì§ˆë¬¸ì…ë‹ˆë‹¤. 
                    {{ friend_info.name }}ë‹˜ì„ ê°ê´€ì ìœ¼ë¡œ í‰ê°€í•´ì£¼ì„¸ìš”.
                {% else %}
                    ê° ë¬¸í•­ì€ "ê·¸ ì‚¬ëŒì€..."ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ì œ3ì ê´€ì ì˜ ì§ˆë¬¸ì…ë‹ˆë‹¤. 
                    ìì‹ ì„ ê°ê´€ì ìœ¼ë¡œ ë°”ë¼ë³´ëŠ” ë§ˆìŒìœ¼ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.
                {% endif %}
            </p>
        </div>
    </div>

    <form method="POST" action="/mbti/result" class="bg-white rounded-lg shadow-lg p-8">
        <!-- ì¹œêµ¬ í‰ê°€ ì •ë³´ (URL íŒŒë¼ë¯¸í„°ì—ì„œ ê°€ì ¸ì˜´) -->
        <input type="hidden" name="friend_email" value="{{ request.query_params.get('friend_email', '') }}">
        
        <!-- í‰ê°€ì ì •ë³´ ì…ë ¥ -->
        {% if request.query_params.get('friend_email') %}
        <div class="mb-6 p-4 bg-purple-50 border border-purple-200 rounded-lg">
            <h3 class="text-lg font-semibold text-purple-800 mb-3">ğŸ‘¥ ì¹œêµ¬ í‰ê°€ ëª¨ë“œ</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="evaluator_name" class="block text-sm font-medium text-gray-700 mb-1">
                        í‰ê°€ì ì´ë¦„ (ì„ íƒì‚¬í•­)
                    </label>
                    <input type="text" 
                           id="evaluator_name" 
                           name="evaluator_name" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                           placeholder="ë‹¹ì‹ ì˜ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div class="flex items-end">
                    <p class="text-sm text-purple-600">
                        {% if friend_info %}
                        ì¹œêµ¬: <strong>{{ friend_info.name }}</strong> ({{ friend_info.email }})
                        {% else %}
                        ì¹œêµ¬ ì´ë©”ì¼: <strong>{{ request.query_params.get('friend_email') }}</strong>
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>
        {% endif %}
        {% for question in questions %}
        <div class="mb-8 p-6 border border-gray-200 rounded-lg hover:border-blue-300 transition-colors">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">
                {{ loop.index }}. 
                {% if friend_info %}
                    {% set question_text = question.question %}
                    {% set question_text = question_text.replace("ê·¸ ì‚¬ëŒì€", friend_info.name + "ì€") %}
                    {% set question_text = question_text.replace("ê·¸ ì‚¬ëŒì´", friend_info.name + "ì´") %}
                    {% set question_text = question_text.replace("ê·¸ ì‚¬ëŒì˜", friend_info.name + "ì˜") %}
                    {% set question_text = question_text.replace("ê·¸ ì‚¬ëŒì„", friend_info.name + "ì„") %}
                    {% set question_text = question_text.replace("ê·¸ ì‚¬ëŒê³¼", friend_info.name + "ê³¼") %}
                    {{ question_text }}
                {% else %}
                    {{ question.question }}
                {% endif %}
            </h3>
            
            <div class="space-y-3">
                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 cursor-pointer transition-colors">
                    <input type="radio" name="q{{ question.id }}" value="1" class="mr-3 text-blue-600" required>
                    <span class="text-gray-700">ì „í˜€ ì•„ë‹ˆë‹¤</span>
                </label>
                
                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 cursor-pointer transition-colors">
                    <input type="radio" name="q{{ question.id }}" value="2" class="mr-3 text-blue-600" required>
                    <span class="text-gray-700">ì•„ë‹ˆë‹¤</span>
                </label>
                
                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 cursor-pointer transition-colors">
                    <input type="radio" name="q{{ question.id }}" value="3" class="mr-3 text-blue-600" required>
                    <span class="text-gray-700">ë³´í†µì´ë‹¤</span>
                </label>
                
                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 cursor-pointer transition-colors">
                    <input type="radio" name="q{{ question.id }}" value="4" class="mr-3 text-blue-600" required>
                    <span class="text-gray-700">ê·¸ë ‡ë‹¤</span>
                </label>
                
                <label class="flex items-center p-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 cursor-pointer transition-colors">
                    <input type="radio" name="q{{ question.id }}" value="5" class="mr-3 text-blue-600" required>
                    <span class="text-gray-700">ë§¤ìš° ê·¸ë ‡ë‹¤</span>
                </label>
            </div>
        </div>
        {% endfor %}

        <div class="text-center">
            <button type="submit" 
                    class="bg-blue-600 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-blue-700 transition-colors">
                ğŸ¯ ê²°ê³¼ í™•ì¸í•˜ê¸°
            </button>
        </div>
    </form>

    <div class="mt-6 text-center">
        <a href="/mbti" class="text-blue-600 hover:text-blue-800 underline">
            â† MBTI í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°
        </a>
    </div>
</div>
{% endblock %} 
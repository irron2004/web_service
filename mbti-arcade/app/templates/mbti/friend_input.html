{% extends "base.html" %}

{% block title %}ì¹œêµ¬ MBTI í‰ê°€ - ì¹œêµ¬ ì •ë³´ ì…ë ¥{% endblock %}

{% block head %}
{{ super() }}
<style>
    .input-field:focus-visible {
        outline: 3px solid rgba(59, 130, 246, 0.65);
        outline-offset: 3px;
    }

    .info-pill {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        border-radius: 9999px;
        background: rgba(255, 255, 255, 0.18);
        padding: 0.35rem 0.9rem;
        font-size: 0.75rem;
        font-weight: 600;
        letter-spacing: 0.04em;
        text-transform: uppercase;
    }
</style>
{% endblock %}

{% block content %}
{% set default_friend_name = prefill_name or "ì¹œêµ¬" %}
{% set default_friend_email = prefill_email or "" %}
{% set default_friend_mbti = prefill_mbti or "" %}

<div class="mx-auto max-w-4xl space-y-10">
    <section class="rounded-3xl bg-gradient-to-br from-purple-600 via-sky-500 to-slate-900 px-6 py-10 text-white">
        <div class="space-y-6">
            <div class="flex flex-wrap items-center gap-3">
                <span class="info-pill">1ë¶„ ì‘ì„±</span>
                <span class="info-pill">ìµëª… ì°¸ì—¬</span>
                <span class="info-pill">3ëª… ì´ìƒ ëª¨ì´ë©´ ê³µê°œ</span>
            </div>
            <h1 class="text-3xl md:text-4xl font-bold leading-tight">ğŸ‘¥ ì¹œêµ¬ MBTI í‰ê°€ ë§í¬ ë§Œë“¤ê¸°</h1>
            <p class="text-base md:text-lg text-white/90">
                ì¹œêµ¬ë‚˜ ë™ë£Œì—ê²Œ â€œë‚˜ë¥¼ ì–´ë–»ê²Œ ë³´ê³  ìˆì„ê¹Œ?â€ë¥¼ ë¬¼ì–´ë³´ì„¸ìš”. ì•„ë˜ ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´ ë°”ë¡œ ê³µìœ í•  ìˆ˜ ìˆëŠ”
                ì°¸ì—¬ ë§í¬ê°€ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. ì„¤ë¬¸ì€ ì§§ê³  ê°„ë‹¨í•˜ë©° ëˆ„êµ¬ë‚˜ í¸í•˜ê²Œ ë‹µí•  ìˆ˜ ìˆì–´ìš”.
            </p>
            <ul class="grid gap-3 text-sm text-white/85 md:grid-cols-3">
                <li class="rounded-2xl bg-white/15 px-4 py-3">ğŸ” ì‘ë‹µì€ ìµëª…ìœ¼ë¡œ ì €ì¥ë˜ì–´ ìš”ì•½ ê²°ê³¼ë¡œë§Œ í™œìš©ë©ë‹ˆë‹¤.</li>
                <li class="rounded-2xl bg-white/15 px-4 py-3">ğŸ”” 3ëª… ì´ìƒ ëª¨ì´ë©´ ì°¨ì´ì ê³¼ ê³µí†µì ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆì–´ìš”.</li>
                <li class="rounded-2xl bg-white/15 px-4 py-3">ğŸš« ê²€ìƒ‰ì— ë…¸ì¶œë˜ì§€ ì•Šìœ¼ë‹ˆ ë§í¬ë¥¼ ë°›ì€ ì‚¬ëŒë§Œ ì°¸ì—¬í•  ìˆ˜ ìˆì–´ìš”.</li>
            </ul>
        </div>
    </section>

    <section class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
        <h2 class="text-xl font-semibold text-slate-900">ì´ë ‡ê²Œ ì§„í–‰ë¼ìš”</h2>
        <ol class="mt-4 space-y-3 text-sm text-slate-600">
            <li class="flex items-start gap-3"><span class="mt-0.5 inline-flex h-6 w-6 items-center justify-center rounded-full bg-indigo-600 text-xs font-bold text-white">1</span> ì¹œêµ¬ê°€ ëˆ„êµ¬ë¥¼ í‰ê°€í•˜ëŠ”ì§€ í‘œì‹œëª…ì„ ì…ë ¥í•´ìš”.</li>
            <li class="flex items-start gap-3"><span class="mt-0.5 inline-flex h-6 w-6 items-center justify-center rounded-full bg-indigo-600 text-xs font-bold text-white">2</span> ë§í¬ë¥¼ ê³µìœ í•˜ë©´ ì¹œêµ¬ê°€ {{ default_friend_name }}ì„(ë¥¼) ë– ì˜¬ë¦¬ë©° ì§ˆë¬¸ì— ë‹µí•©ë‹ˆë‹¤.</li>
            <li class="flex items-start gap-3"><span class="mt-0.5 inline-flex h-6 w-6 items-center justify-center rounded-full bg-indigo-600 text-xs font-bold text-white">3</span> ì°¸ì—¬ìê°€ 3ëª… ì´ìƒ ëª¨ì´ë©´ ì°¨ì´ì™€ ê³µí†µì ì„ ì •ë¦¬í•œ ì¸ì‚¬ì´íŠ¸ê°€ ì—´ë¦½ë‹ˆë‹¤.</li>
        </ol>
    </section>

    <section class="rounded-3xl border border-slate-200 bg-white p-6 shadow-lg">
        <form method="POST" class="space-y-6">
            {% if prefill_name or prefill_email or prefill_mbti %}
            <div class="rounded-2xl border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-700">
                <p class="font-semibold">âœ… ì €ì¥í•´ ë‘” ì •ë³´ê°€ ë¶ˆëŸ¬ì™€ì¡Œì–´ìš”.</p>
                <ul class="mt-2 space-y-1">
                    {% if prefill_name %}<li>â€¢ ì¹œêµ¬ ì´ë¦„: {{ prefill_name }}</li>{% endif %}
                    {% if prefill_email %}<li>â€¢ ì¹œêµ¬ ì´ë©”ì¼: {{ prefill_email }}</li>{% endif %}
                    {% if prefill_mbti %}<li>â€¢ ì¹œêµ¬ MBTI: {{ prefill_mbti }}</li>{% endif %}
                </ul>
            </div>
            {% endif %}

            <div>
                <label for="friend_name" class="block text-sm font-medium text-slate-700">ì¹œêµ¬ ì´ë¦„ *</label>
                <input id="friend_name" name="friend_name" value="{{ default_friend_name if default_friend_name != 'ì¹œêµ¬' else '' }}" required maxlength="50" class="input-field mt-2 w-full rounded-xl border border-slate-200 px-4 py-3 text-base text-slate-900 shadow-sm focus-visible:ring-4 focus-visible:ring-indigo-200" placeholder="ì˜ˆ: ê¹€ì„œìœ¤">
                <p class="mt-2 text-xs text-slate-500">ë¬¸í•­ ì† ì§€ì¹­ê³¼ ê²°ê³¼ ì¹´ë“œì— ê·¸ëŒ€ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
            </div>

            <div>
                <label for="friend_email" class="block text-sm font-medium text-slate-700">ì¹œêµ¬ ì´ë©”ì¼</label>
                <input id="friend_email" type="email" name="friend_email" value="{{ default_friend_email }}" maxlength="120" class="input-field mt-2 w-full rounded-xl border border-slate-200 px-4 py-3 text-base text-slate-900 shadow-sm focus-visible:ring-4 focus-visible:ring-indigo-200" placeholder="friend@example.com">
                <p class="mt-2 text-xs text-slate-500">ì„ íƒ ì‚¬í•­ Â· ê²°ê³¼ ë§í¬ë¥¼ ìë™ ì „ë‹¬í•˜ë ¤ë©´ ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.</p>
            </div>

            <div>
                <label for="friend_mbti" class="block text-sm font-medium text-slate-700">ì¹œêµ¬ ì‹¤ì œ MBTI</label>
                <input id="friend_mbti" name="friend_mbti" value="{{ default_friend_mbti }}" maxlength="4" class="input-field mt-2 w-full rounded-xl border border-slate-200 px-4 py-3 text-base text-slate-900 uppercase shadow-sm focus-visible:ring-4 focus-visible:ring-indigo-200" placeholder="ì˜ˆ: INFP">
                <p class="mt-2 text-xs text-slate-500">ì•Œê³  ìˆëŠ” ê²½ìš° ì…ë ¥í•˜ë©´ ê²°ê³¼ ë¹„êµ ì¹´ë“œì— í‘œì‹œë¼ìš”.</p>
            </div>

            <div>
                <label for="friend_relationship" class="block text-sm font-medium text-slate-700">ê´€ê³„ ë©”ëª¨</label>
                <input id="friend_relationship" name="friend_relationship" maxlength="80" class="input-field mt-2 w-full rounded-xl border border-slate-200 px-4 py-3 text-base text-slate-900 shadow-sm focus-visible:ring-4 focus-visible:ring-indigo-200" placeholder="ì˜ˆ: ëŒ€í•™ ë™ê¸°, ì§ì¥ ë™ë£Œ, ê°€ì¡± ë“±">
                <p class="mt-2 text-xs text-slate-500">ìƒëŒ€ê°€ í‰ê°€í•˜ë©´ì„œ ì°¸ê³ í•  ê°„ë‹¨í•œ ì„¤ëª…ì„ ë‚¨ê²¨ì£¼ì„¸ìš”.</p>
            </div>

            <div class="rounded-2xl border border-blue-200 bg-blue-50 px-4 py-3 text-sm text-blue-700">
                <p><strong>ì•ˆë‚´:</strong> ì•„ë˜ í…ŒìŠ¤íŠ¸ëŠ” <span id="friend_name_display">{{ default_friend_name }}</span>ì„(ë¥¼) ë– ì˜¬ë¦¬ë©° ì§„í–‰ë¼ìš”.<br>â€œë‚´ê°€ <span id="friend_name_display2">{{ default_friend_name }}</span>ì´ë¼ë©´ ì–´ë–»ê²Œ í–‰ë™í• ê¹Œ?â€ë¥¼ ìƒê°í•˜ë©° ì‘ë‹µì„ ë¶€íƒí•´ ì£¼ì„¸ìš”.</p>
            </div>

            <button type="submit" class="w-full rounded-xl bg-gradient-to-r from-indigo-600 via-sky-500 to-emerald-500 px-6 py-3 text-base font-semibold text-white shadow-lg shadow-indigo-600/40 transition hover:-translate-y-0.5">
                ğŸ”— MBTI í‰ê°€ ë§í¬ ìƒì„±
            </button>
        </form>

        <div class="mt-6 text-center">
            <a href="/mbti/" class="text-sm font-medium text-indigo-600 hover:text-indigo-700">â† MBTI í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>
    </section>

    <section class="rounded-2xl border border-purple-200 bg-purple-50 p-6 text-sm text-purple-700">
        <h2 class="text-base font-semibold text-purple-900">ì•ˆì‹¬í•˜ê³  ì‚¬ìš©í•˜ì„¸ìš”</h2>
        <ul class="mt-3 space-y-1">
            <li>â€¢ ì‘ë‹µìëŠ” ìµëª…ìœ¼ë¡œ ì°¸ì—¬í•˜ë©°, ê²°ê³¼ëŠ” ìš”ì•½ í†µê³„ë¡œë§Œ ë³´ì—¬ì§‘ë‹ˆë‹¤.</li>
            <li>â€¢ ë§í¬ëŠ” ê²€ìƒ‰ì—”ì§„ì— ë…¸ì¶œë˜ì§€ ì•Šì•„ ì´ˆëŒ€í•œ ì‚¬ëŒë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆì–´ìš”.</li>
            <li>â€¢ ì–¸ì œë“ ì§€ ìƒˆë¡œìš´ ë§í¬ë¥¼ ë§Œë“¤ì–´ í•„ìš”í•œ ì‚¬ëŒì—ê²Œë§Œ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
        </ul>
    </section>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    var friendNameInput = document.getElementById('friend_name');
    var display1 = document.getElementById('friend_name_display');
    var display2 = document.getElementById('friend_name_display2');

    var updateDisplays = function (value) {
        var fallback = value && value.trim() ? value.trim() : '{{ default_friend_name|escapejs }}';
        display1.textContent = fallback;
        display2.textContent = fallback;
    };

    if (friendNameInput) {
        updateDisplays(friendNameInput.value);
        friendNameInput.addEventListener('input', function (event) {
            updateDisplays(event.target.value);
        });
    }

    var params = new URLSearchParams(window.location.search);
    var nameParam = params.get('name');
    var emailParam = params.get('email');
    var mbtiParam = params.get('mbti');
    if (nameParam && friendNameInput && !friendNameInput.value) {
        friendNameInput.value = nameParam;
        updateDisplays(nameParam);
    }
    var emailInput = document.getElementById('friend_email');
    if (emailParam && emailInput && !emailInput.value) {
        emailInput.value = emailParam;
    }
    var mbtiInput = document.getElementById('friend_mbti');
    if (mbtiParam && mbtiInput && !mbtiInput.value) {
        mbtiInput.value = mbtiParam;
    }
});
</script>
{% endblock %}

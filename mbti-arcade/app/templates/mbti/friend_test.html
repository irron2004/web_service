{% extends "base.html" %}

{% block title %}ì¹œêµ¬ MBTI í…ŒìŠ¤íŠ¸ - MBTI & Arcade Web Service{% endblock %}

{% block head %}
{{ super() }}
<style>
    .question-card:focus-within {
        box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.25);
        border-color: rgba(124, 58, 237, 0.6);
    }

    .scale-option:focus-visible {
        outline: 3px solid rgba(124, 58, 237, 0.9);
        outline-offset: 4px;
    }

    .relation-option {
        border: 1px solid rgba(148, 163, 184, 0.35);
        border-radius: 1rem;
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
        background: rgba(255, 255, 255, 0.9);
    }

    .relation-option:focus-within {
        border-color: rgba(124, 58, 237, 0.55);
        box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2);
    }

    .relation-option input:checked + .relation-body {
        background: linear-gradient(135deg, rgba(124, 58, 237, 0.9), rgba(59, 130, 246, 0.9));
        color: #fff;
    }

    .relation-body {
        border-radius: 0.9rem;
        padding: 1rem 1.25rem;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        min-height: 100%;
        transition: background 0.2s ease, color 0.2s ease;
    }

    .relation-body span {
        color: inherit;
    }
</style>
{% endblock %}

{% block content %}
{% set target_name = (friend.name if friend else friend_name) or "ì¹œêµ¬" %}
{% set owner_name = friend_name or "ê³µìœ ì" %}
{% set owner_mbti = my_mbti or "ë¹„ê³µê°œ" %}
{% set scale_options = [
    (1, "ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤"),
    (2, "ê·¸ë ‡ì§€ ì•Šì€ í¸"),
    (3, "ë³´í†µ"),
    (4, "ê·¸ëŸ° í¸"),
    (5, "ë§¤ìš° ê·¸ë ‡ë‹¤")
] %}
{% set relation_labels = {
    "friend": "ì¹œêµ¬",
    "boyfriend": "ë‚¨ìì¹œêµ¬",
    "girlfriend": "ì—¬ìì¹œêµ¬",
    "partner": "ì—°ì¸",
    "couple": "ë°°ìš°ì",
    "family": "ê°€ì¡±",
    "colleague": "ë™ë£Œ",
    "acquaintance": "ì§€ì¸"
} %}
{% set relation_notes = {
    "friend": "í•¨ê»˜ ì‹œê°„ì„ ìì£¼ ë³´ë‚´ëŠ” ì¹œêµ¬",
    "boyfriend": "ì—°ì¸ ê´€ê³„ (ë‚¨ìì¹œêµ¬)",
    "girlfriend": "ì—°ì¸ ê´€ê³„ (ì—¬ìì¹œêµ¬)",
    "partner": "ì»¤í”Œ/íŒŒíŠ¸ë„ˆ ê´€ê³„",
    "couple": "ë°°ìš°ì Â· ê²°í˜¼ ê´€ê³„",
    "family": "ê°€ì¡±/ì¹œì²™",
    "colleague": "ì§ì¥ Â· í”„ë¡œì íŠ¸ ë™ë£Œ",
    "acquaintance": "ìˆ˜ì—…/ë™í˜¸íšŒ ë“± ì§€ì¸"
} %}

<div class="mx-auto max-w-5xl space-y-10">
    <section class="rounded-3xl bg-gradient-to-br from-purple-600 via-sky-600 to-emerald-500 px-6 py-10 text-white">
        <div class="space-y-5">
            <span class="inline-flex items-center rounded-full bg-white/15 px-4 py-1 text-xs font-semibold uppercase tracking-wide">ì´ˆëŒ€ ì°¸ì—¬ ì•ˆë‚´</span>
            <h1 class="text-3xl md:text-4xl font-bold leading-tight">ğŸ¯ {{ target_name }}ë‹˜ì„ ë– ì˜¬ë¦¬ë©° ì‘ë‹µí•´ ì£¼ì„¸ìš”</h1>
            <p class="text-base md:text-lg text-white/90">
                {{ owner_name }}ë‹˜ì´ ë§ˆë ¨í•œ ì¸ì‹ ì²´í¬ì— ì°¸ì—¬í•˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤. ì¼ìƒì—ì„œì˜ {{ target_name }}ë‹˜ì˜ ëª¨ìŠµì„ ë– ì˜¬ë¦¬ë©° ì†”ì§í•˜ê²Œ ë‹µí•´ ì£¼ì„¸ìš”.
                ë‹µë³€ì€ ìµëª…ìœ¼ë¡œ ëª¨ì´ê³ , 3ëª… ì´ìƒì´ ì°¸ì—¬í•˜ë©´ ê²°ê³¼ ìš”ì•½ì´ ì—´ë¦½ë‹ˆë‹¤.
            </p>
            <dl class="grid gap-4 rounded-2xl bg-white/15 p-4 text-sm md:grid-cols-3">
                <div>
                    <dt class="font-semibold text-white/70">ê³µìœ ì</dt>
                    <dd class="mt-1 text-white font-semibold">{{ owner_name }}</dd>
                </div>
                <div>
                    <dt class="font-semibold text-white/70">ê³µìœ ì MBTI</dt>
                    <dd class="mt-1 text-white font-semibold">{{ owner_mbti }}</dd>
                </div>
                <div>
                    <dt class="font-semibold text-white/70">í‰ê°€ ëŒ€ìƒ</dt>
                    <dd class="mt-1 text-white font-semibold">{{ target_name }}</dd>
                </div>
            </dl>
        </div>
    </section>

    <section class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
        <h2 class="text-xl font-semibold text-slate-900">ì°¸ì—¬ ë°©ë²•</h2>
        <p class="mt-3 text-sm text-slate-600">
            ì§ˆë¬¸ì€ ëª¨ë‘ "ê·¸ ì‚¬ëŒì€â€¦" í˜•ì‹ì…ë‹ˆë‹¤. {{ target_name }}ë‹˜ì´ í‰ì†Œì— ë³´ì—¬ì£¼ëŠ” ëª¨ìŠµì„ ë– ì˜¬ë¦¬ë©°, ê°€ì¥ ê°€ê¹Œìš´ ì„ íƒì§€ë¥¼ ê³¨ë¼ ì£¼ì„¸ìš”.
            1ì€ "ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤", 5ëŠ” "ë§¤ìš° ê·¸ë ‡ë‹¤"ë¥¼ ëœ»í•©ë‹ˆë‹¤.
        </p>
        <ul class="mt-4 grid gap-3 text-sm text-slate-600 md:grid-cols-3">
            <li class="rounded-xl bg-slate-50 px-4 py-3">âœ… ë‹µë³€ì€ ìµëª…ìœ¼ë¡œ ì €ì¥ë˜ë©°, ìš”ì•½ ê²°ê³¼ì—ë§Œ í™œìš©ë©ë‹ˆë‹¤.</li>
            <li class="rounded-xl bg-slate-50 px-4 py-3">ğŸ“¬ {{ owner_name }}ë‹˜ì´ ê²°ê³¼ ìš”ì•½ì„ í™•ì¸í•˜ê³  ê³µìœ  ì—¬ë¶€ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.</li>
            <li class="rounded-xl bg-slate-50 px-4 py-3">ğŸ“ˆ 3ëª… ì´ìƒ ì°¸ì—¬í•˜ë©´ ê°•ì ê³¼ ì°¨ì´ì ì„ ê·¸ë˜í”„ë¡œ ë³´ì—¬ë“œë ¤ìš”.</li>
        </ul>
    </section>

    <form action="/mbti/result/{{ token }}" method="POST" class="space-y-8">
        <input type="hidden" name="token" value="{{ token }}">

        <section class="rounded-2xl border border-slate-200 bg-white p-6 shadow-sm">
            <fieldset aria-describedby="relation-hint">
                <legend class="text-xl font-semibold text-slate-900">ğŸ¤ {{ target_name }}ë‹˜ê³¼ì˜ ê´€ê³„ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”</legend>
                <p class="mt-2 text-sm text-slate-500" id="relation-hint">
                    ì‘ë‹µì ì •ë³´ë¥¼ ê°„ë‹¨íˆ ë‚¨ê²¨ ë‘ë©´ ë¦¬í¬íŠ¸ì—ì„œ ê´€ê³„ë³„ë¡œ ëª¨ì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
                <div class="mt-5 grid gap-4 sm:grid-cols-2">
                    {% for relation in relations %}
                    {% set option_id = "relation-" ~ loop.index %}
                    {% set label_text = relation_labels.get(relation, relation.replace('_', ' ')|title) %}
                    {% set note_text = relation_notes.get(relation) %}
                    <label class="relation-option block" for="{{ option_id }}">
                        <input type="radio" id="{{ option_id }}" name="relation" value="{{ relation }}" {% if loop.first %}required{% endif %} class="sr-only">
                        <div class="relation-body">
                            <span class="text-base font-semibold">{{ label_text }}</span>
                            {% if note_text %}
                            <span class="text-xs opacity-80">{{ note_text }}</span>
                            {% endif %}
                        </div>
                    </label>
                    {% endfor %}
                </div>
            </fieldset>
        </section>

        <section class="space-y-6">
            {% for question in questions %}
            {% set base_name = "q" ~ question.id %}
            <fieldset class="question-card rounded-2xl border border-slate-200 bg-white p-6 shadow-sm transition-colors" aria-describedby="{{ base_name }}-hint">
                <legend class="flex items-start gap-3 text-lg font-semibold text-slate-900">
                    <span class="mt-1 inline-flex h-8 w-8 items-center justify-center rounded-full bg-purple-600 text-sm font-bold text-white">{{ loop.index }}</span>
                    <span>{{ question.question }}</span>
                </legend>
                <p id="{{ base_name }}-hint" class="mt-3 text-sm text-slate-500">
                    ë°©í–¥í‚¤ ë˜ëŠ” íƒ­+ìŠ¤í˜ì´ìŠ¤ë¡œë„ ì„ íƒí•  ìˆ˜ ìˆì–´ìš”. ê³ ë¯¼ë  ë• ê°€ì¥ ê°€ê¹Œìš´ ìª½ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.
                </p>
                <div class="mt-5 grid gap-3 sm:grid-cols-2 lg:grid-cols-5" role="radiogroup">
                    {% for value, label in scale_options %}
                    {% set input_id = base_name ~ "-" ~ loop.index %}
                    <label for="{{ input_id }}" class="scale-option flex items-center gap-3 rounded-xl border border-slate-200 px-4 py-3 text-sm font-medium text-slate-700 transition hover:border-purple-400 hover:bg-purple-50">
                        <input id="{{ input_id }}" type="radio" name="{{ base_name }}" value="{{ value }}" class="h-4 w-4 text-purple-600" {% if loop.first %}required{% endif %}>
                        <span>{{ label }}</span>
                    </label>
                    {% endfor %}
                </div>
            </fieldset>
            {% endfor %}
        </section>

        <div class="sticky bottom-6 z-10 flex justify-end">
            <button type="submit" class="inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-purple-600 via-indigo-600 to-sky-500 px-6 py-3 text-base font-semibold text-white shadow-lg shadow-indigo-600/30 transition hover:-translate-y-0.5">
                ğŸš€ í‰ê°€ ì œì¶œí•˜ê¸°
            </button>
        </div>
    </form>

    <section class="grid gap-6 rounded-2xl border border-amber-200 bg-amber-50 p-6 text-sm text-amber-700 md:grid-cols-2">
        <div>
            <h3 class="text-base font-semibold text-amber-800">ğŸ’¡ ë” ì •í™•í•˜ê²Œ ë‹µí•˜ëŠ” ë°©ë²•</h3>
            <ul class="mt-3 space-y-1">
                <li>â€¢ ìµœê·¼ í•œë‘ ë²ˆì˜ ì¼ë³´ë‹¤, í‰ì†Œ ë°˜ë³µë˜ëŠ” ëª¨ìŠµì„ ë– ì˜¬ë ¤ ë³´ì„¸ìš”.</li>
                <li>â€¢ í•¨ê»˜ ì§€ë‚¸ ë‹¤ì–‘í•œ ìˆœê°„ì„ ëŒì´ì¼œ ë³´ë©´ ë„ì›€ì´ ë©ë‹ˆë‹¤.</li>
                <li>â€¢ ì• ë§¤í•˜ë©´ ì¤‘ê°„ê°’ì„ ì„ íƒí•´ë„ ê´œì°®ì•„ìš”. í™•ì‹ ì´ ìˆì„ ë•Œë§Œ ê·¹ë‹¨ê°’ì„ ì„ íƒí•˜ì„¸ìš”.</li>
            </ul>
        </div>
        <div>
            <h3 class="text-base font-semibold text-amber-800">ğŸ“Š ê²°ê³¼ëŠ” ì´ë ‡ê²Œ ë³´ì—¬ë“œë ¤ìš”</h3>
            <ul class="mt-3 space-y-1">
                <li>â€¢ ì°¸ì—¬ê°€ ëª¨ì´ë©´ ê°•ì ê³¼ ë‹¤ë¥¸ ì ì„ ìš”ì•½í•œ ì¹´ë“œê°€ ìƒì„±ë©ë‹ˆë‹¤.</li>
                <li>â€¢ ê´€ê³„ë³„ë¡œ ëŠë‚€ ì°¨ì´ë¥¼ ê·¸ë˜í”„ì™€ ë¬¸ì¥ìœ¼ë¡œ ì •ë¦¬í•´ ë“œë¦½ë‹ˆë‹¤.</li>
                <li>â€¢ ì œì¶œí•œ ë‹µë³€ì€ ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ì–´ ë‚˜ì¤‘ì— ë‹¤ì‹œ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.</li>
            </ul>
        </div>
    </section>
</div>
{% endblock %}
